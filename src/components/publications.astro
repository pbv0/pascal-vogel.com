---
import publications from "../data/publications.json";
import { format } from "date-fns";

function groupByYear(data) {
  return data.reduce((acc, item) => {
    (acc[item.year] = acc[item.year] || []).push(item);
    return acc;
  }, {});
}

const groupedPublications = groupByYear(publications);
---

<div>
  <h2 class="font-bold text-3xl mb-6">Publications</h2>
  <div>
    {
      Object.entries(groupedPublications)
        .sort(([yearA], [yearB]) => yearB - yearA)
        .map(([year, yearlyPublications]) => (
          <div class="mt-4">
            <h2 class="text-2xl font-bold">{year}</h2>
            <div class="mb-8">
              {yearlyPublications
                .sort((a, b) => new Date(b.published) - new Date(a.published))
                .map(({ published, url, title, outlet }) => (
                  <div class="mt-6">
                    <a href={url} class="hover:underline">
                      <p class="text-xl font-sans leading-8">
                        <span class="text-emerald-200">{title}</span>
                        <span class="text-gray-200">
                          {" "}
                          - {format(new Date(published), "MMMM d, yyyy")}
                        </span>
                      </p>
                    </a>
                  </div>
                ))}
            </div>
          </div>
        ))
    }
  </div>
</div>
