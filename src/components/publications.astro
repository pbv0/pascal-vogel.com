---
import publications from "../data/publications.json";
import { format } from "date-fns";

function groupByYear(data) {
  return data.reduce((acc, item) => {
    (acc[item.year] = acc[item.year] || []).push(item);
    return acc;
  }, {});
}

const groupedPublications = groupByYear(publications);
---

<div>
  <h2 class="font-bold text-2xl md:text-3xl mb-6">Publications</h2>
  <div>
    {
      Object.entries(groupedPublications)
        .sort(([yearA], [yearB]) => yearB - yearA)
        .map(([year, yearlyPublications]) => (
          <div class="mt-4">
            <h2 class="text-lg md:text-2xl font-bold">{year}</h2>
            <div class="mb-8">
              {yearlyPublications
                .sort((a, b) => new Date(b.published) - new Date(a.published))
                .map(({ published, url, title, outlet }) => (
                  <div class="mt-6">
                    <p class="text-lg md:text-xl font-sans leading-9">
                      <a href={url} class="hover:underline">
                        <span class="text-amber-300">{title}</span>{" "}
                      </a>
                      <span class="text-gray-200">
                        {" "}
                        - {format(new Date(published), "MMMM d, yyyy")}
                      </span>
                    </p>
                  </div>
                ))}
            </div>
          </div>
        ))
    }
  </div>
</div>
